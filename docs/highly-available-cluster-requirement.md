# 公有云平台高可用版安装

## 环境要求

### 基础配置

* 云主机

| 配置项目                      | 最低配置要求        |
|---------------------------|---------------|
| 主机数量                      | 3台（配置相同）的云主机  |
| 主机名                       | 各台云主机的主机名必须不同 |
| vCPU                      | 4 vCPU 及以上    |
| 内存                        | 12 G 及以上      |
| 磁盘类型                      | 使用云厂商推荐类型即可   |
| 系统盘（根目录 / ）               | 100G以上        |
| 数据盘（挂载数据目录 /squids/data ） | 200G以上        |

* 负载均衡器
    * 负载均衡器需要和云主机在相同区域
    * 负载均衡器需要和云主机私网连通
    * 负载均衡器实例类型为公网负载均衡实例
    * 需要将云主机加为负载均衡器的后端服务器

### 网络配置

#### 网络

* 云主机

| 配置项目                      | 配置要求          |
|---------------------------|---------------|
| 是否分配公网 IPv4 地址            | 是（建议使用弹性公网IP） |
| 公网带宽                      | 建议 50 Mbps 以上 |

* 负载均衡器
    * 类型
        * 阿里云：传统负载均衡 CLB
        * 腾讯云：公网类型负载均衡 CLB
        * 华为云：独享网络型或共享型

| 配置项目 | 配置要求          |
|------|---------------|
| 实例类型 | 公网            |
| IP版本 | IPv4          |
| 带宽   | 建议 20 Mbps 以上 |

#### 服务器安全组

* 入站规则

| 协议   | 端口    | 来源        | 备注                           |
|------|-------|-----------|------------------------------|
| ICMP | -1/-1 | 0.0.0.0/0 | PING                         |
| TCP  | 22    | 0.0.0.0/0 | SSH                          |
| TCP  | 6443  | 0.0.0.0/0 | k8s kube-apiserver advertise |
| TCP  | 4240  | 0.0.0.0/0 | k8s cni health checks        |
| UDP  | 8472  | 0.0.0.0/0 | k8s cni VXLAN overlay        |
| 全部   | -1/-1 | VPC cidr  | vpc infra connect            |

* 出站规则

| 协议  | 端口    | 目的        | 备注                           |
|-----|-------|-----------|------------------------------|
| 全部  | -1/-1 | 0.0.0.0/0 | allow-all-egress             |

#### 负载均衡器监听

| 协议  | 前端端口  | 后端端口  | 备注                   |
|-----|-------|-------|----------------------|
| TCP | 80    | 80    | squids console       |
| TCP | 30001 | 30001 | squids metrics chart |
| TCP | 30443 | 30443 | squids service       |
| TCP | 30445 | 30445 | squids service       |
| TCP | 30447 | 30447 | squids service       |
| TCP | 6443  | 6443  | squids console       |

如您对以上环境配置要求有任何疑问，可以联系 [在线客服](#) 进行咨询。

### 其他

* Squids 平台注册登录、集群创建、监控告警等功能均依赖于邮件功能，在安装部署之前您需要准备一个**可用的发件邮箱**。

